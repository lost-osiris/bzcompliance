{% block content %}
<div class="container">
   <table class="table table-striped">
      <thead>
         <tr>
            <th>Name</th>
            <th>
               <form action="/compliance">
                  <button type="submit" class="btn btn-default" target="compliance">
                  <span class="glyphicon glyphicon-refresh"></span> Refresh</button>
               </form>
            </th>
            <th style="text-align:right; padding-right: 16px">
               <button type="button" class="btn btn-success btn-sm"
                  data-toggle="modal" data-target="#addproduct-modal">Add Product
               </button>
            </th>
         </tr>
      </thead>
   </table>

   {% for product in products %}
      <div class="panel panel-default">
         <div class="panel-heading">
            <div class="row">
               <div class="col-md-2" style="padding-top:3px">
                  <h1 class="panel-title">
                     <a data-toggle="collapse" href="#{{ product.product_name }}">{{ product.product_name }}</a>
                  </h1>
               </div>
               <form method="post">{% csrf_token %}
                  <div class="col-md-10" align="right">
                     <button type="submit" value="{{ product.product_name }}" 
                        id="submit" name="delete_product" class="btn btn-danger btn-sm">
                        <span class="glyphicon glyphicon-remove"></span> Remove
                     </button>
                  </div>
               </form>
            </div>
         </div>
         <div id="{{ product.product_name }}" class="panel-collapse collapse">
            <div class="panel-body">
               {% if "req" in product %}
                  <div class="row">
                     <div class="col-md-10">
                        <label for="{{ product.product_name }}">Requirement Expression</label>
                        <textarea class="form-control" style="resize:vertical" 
                           id="{{ product.product_name }}-req-expression" 
                           readonly>{{ product.req.expression }}</textarea>
                     </div>
                     <div class="col-md-2" align="left" style="margin-top:24px; padding:0px">
                        <form method="post">{% csrf_token %}
                           <button class="btn btn-primary" type="submit" name="add_req" 
                              value="{{ product.product_name }}">
                              <span class="glyphicon glyphicon-edit"></span> Edit</button>
                           <input type="hidden" name="req_type" value="product">
                        </form>
                     </div>
                  </div>
                  <br />
               {% else %}
                  <div class="row">
                     <div class="col-md-12" align="left">
                        <form method="post">{% csrf_token %}
                           <button class="btn btn-default" type="submit" name="add_req" 
                              value="{{ product.product_name }}">
                              Add Requirment</button>
                           <input type="hidden" name="req_type" value="product">
                        </form>
                     </div>
                  </div>
               {% endif %}


               {% include "bz/groups/all_groups.html" %}
            </div>
         </div>
      </div>
   {% endfor %}

   {% include "bz/products/add_product.html" %}

</div>
{% endblock %}
